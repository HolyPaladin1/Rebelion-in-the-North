#textdomain wesnoth-Rebellion_in_the_North
[scenario]
    id=28_End_of_the_Rebellion
    name=_ "End of the Rebellion"
    map_data="{~add-ons/Rebellion_in_the_North/maps/28_End_of_the_Rebellion.map}"
    turns=-1
    next_scenario=29_Epilogue
    victory_when_enemies_defeated="yes"
    {AFTERNOON}
    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {DAWN}
    {MORNING}
    {DEFAULT_MUSIC_PLAYLIST}

    [story]
    [part]
    story= _ "Only two days had passed since Krshan,Aric,Vaman and Princess Radah had their light-hearted discussion a gryphon rider flew into Dwarven Doors bringing report that the rebel leader Bakkhil had arrived in the not-so known orcish tribal city of Rumyr with a substantial force.More of the rebels were assembling there."
    background=maps/wesnoth.png
    [/part]
    [part]
    story= _ "Rumyr was officially within Alliance territory,but being at the remotest corner it functioned almost autonomously.The journey from Dwarven Doors to Rumyr was very difficult and time consuming even during the summer.But Krshan was determined to root out the evil this time.He sent an informer to Vaman and a gryphon to Krag Kumbha requesting them to join the encounter."
    background=maps/wesnoth.png
    [/part]
    [part]
    story= _ "Vaman appeared at Dwarven Doors within a fortnight.He had been elected the king of their indeed,and brought with him not only the veterans of the far-north but also quite a few novices.Krag Kumbha sent back a message with the gryphon that he would be landing at Glamdrol within a month."
    background=maps/wesnoth.png
    [/part]
    [part]
    story= _ "The humans and dwarves travelled to Glamdrol once more.Krag Kumbha arrived on time.Together they marched on the rebel stronghold of Rumyr where Bakkhil had gathered a formidable army.Krag Kumbha decided to attack from the north and separated from them with some dwarf guides.The others camped south-west of the fortress."
    background=maps/wesnoth.png
    [/part]
    [part]
    show_title=yes
    background=maps/wesnoth.png
    [/part]
    [/story]

    [side]
    type=Grand Marshal
    id=Krshan
    name=_"Krshan"
    side=1
    canrecruit=yes
    controller=human
    {GOLD 550 400 400}
    team_name=Alliance
    user_team_name=_"Alliance"
    fog="no"
    share_view="yes"
    shroud="no"
    share_maps="no"
    income="0"
    recruit=Bowman, Spearman, Footpad, Poacher, Thug, Gryphon Rider, Cavalryman, Horseman, Mage
    [/side]
    {STARTING_VILLAGES 1 4}

    [side]
    type=Orcish Sovereign
    controller=ai
    id=Krag Kumbha
    name=_"Krag Kumbha"
    side=2
    [modifications]
    {TRAIT_QUICK}
    {TRAIT_RESILIENT}
    [/modifications]
    profile=portraits/kumbha.png
    canrecruit=yes
    {GOLD 1500 1300 1100}
    recruit="Orcish Warrior, Orcish Crossbowman, Goblin Knight, Goblin Pillager, Orcish Slayer, Orcish Grunt, Orcish Archer, Wolf Rider, Troll Whelp, Orcish Assassin, Troll, Troll Rocklobber"
    team_name=Alliance
    user_team_name=_"Alliance"
    income="6"
    persistent=yes
    fog="no"
    share_view="no"
    shroud="no"
    [ai]
        recruitment_ignore_bad_combat=yes
        recruitment_ignore_bad_movement=yes
        passive_leader=yes
    [/ai]
    [/side]
    {STARTING_VILLAGES 2 6}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Orcish Slayer" 2}

    [side]
    type=Orcish Sovereign
    controller=ai
    id=Bakkhil
    name=_"Bakkhil"
    profile=portraits/Bakkhil.png
    side=3
    canrecruit=yes
    {GOLD 800 1200 1400}
    recruit="Orcish Warrior, Orcish Crossbowman, Goblin Knight, Goblin Pillager, Orcish Slayer, Orcish Grunt, Orcish Archer, Wolf Rider, Ogre, Orcish Assassin"
    team_name=Enemies
    user_team_name=_"Enemies"
    {INCOME 8 10 12}
    [ai]
        recruitment_ignore_bad_combat=yes
        recruitment_ignore_bad_movement=yes
        passive_leader=yes

        [target]
        side=1
        value=5.0
        [/target]
      
        [target]
        side=2
        value=3.0
        [/target]
  
        [target]
        side=8
        value=4.0
        [/target]
 
        [target]
        side=9
        value=2.0
        [/target]
    [/ai]
    [/side]
    {STARTING_VILLAGES 3 10}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 "Orcish Slayer" 2}

    {FORCE_CHANCE_TO_HIT side=1 id="Bakkhil" 0 (
    {VARIABLE_CONDITIONAL turn_number less_than 13}
)}
    {FORCE_CHANCE_TO_HIT side=2 id="Bakkhil" 0 (
    {VARIABLE_CONDITIONAL turn_number less_than 13}
)}
    {FORCE_CHANCE_TO_HIT side=8 id="Bakkhil" 0 (
    {VARIABLE_CONDITIONAL turn_number less_than 13}
)}

    [side]
    type=Orcish Warlord
    controller=ai
    generate_name=yes
    side=4
    canrecruit=yes
    {GOLD 400 600 700}
    recruit="Orcish Warrior, Orcish Crossbowman, Goblin Knight, Orcish Slayer, Ogre, Orcish Grunt, Orcish Archer, Wolf Rider"
    team_name=Enemies
    user_team_name=_"Enemies"
    income="6"
    [ai]
        recruitment_ignore_bad_combat=yes
        recruitment_ignore_bad_movement=yes

        [target]
        side=1
        value=5.0
        [/target]
      
        [target]
        side=2
        value=3.0
        [/target]
  
        [target]
        side=8
        value=4.0
        [/target]
 
        [target]
        side=9
        value=2.0
        [/target]
    [/ai]
    [/side]
    {STARTING_VILLAGES 4 3}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Orcish Slayer" 2}

    [side]
    type=Orcish Warlord
    controller=ai
    generate_name=yes
    side=5
    canrecruit=yes
    {GOLD 400 600 700}
    recruit="Orcish Warrior, Orcish Crossbowman, Goblin Knight, Orcish Slayer, Ogre, Orcish Grunt, Orcish Archer, Wolf Rider"
    team_name=Enemies
    user_team_name=_"Enemies"
    income="6"
    [ai]
        recruitment_ignore_bad_combat=yes
        recruitment_ignore_bad_movement=yes

        [target]
        side=1
        value=5.0
        [/target]
      
        [target]
        side=2
        value=3.0
        [/target]
  
        [target]
        side=8
        value=4.0
        [/target]
 
        [target]
        side=9
        value=2.0
        [/target]
    [/ai]
    [/side]
    {STARTING_VILLAGES 5 3} 
    {LIMIT_CONTEMPORANEOUS_RECRUITS 5 "Orcish Slayer" 2}

    [side]
    type=Orcish Warlord
    controller=ai
    generate_name=yes
    side=6
    canrecruit=yes
    {GOLD 400 600 700}
    recruit="Orcish Warrior, Orcish Crossbowman, Goblin Knight, Orcish Slayer, Ogre, Orcish Grunt, Orcish Archer, Wolf Rider"
    team_name=Enemies
    user_team_name=_"Enemies"
    income="6"
    [ai]
        recruitment_ignore_bad_combat=yes
        recruitment_ignore_bad_movement=yes

        [target]
        side=1
        value=5.0
        [/target]
      
        [target]
        side=2
        value=3.0
        [/target]
  
        [target]
        side=8
        value=4.0
        [/target]
 
        [target]
        side=9
        value=2.0
        [/target]
    [/ai]
    [/side]
    {STARTING_VILLAGES 6 3}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 6 "Orcish Slayer" 2} 


    [side]
    type=Orcish Warlord
    controller=ai
    generate_name=yes
    side=7
    canrecruit=yes
    {GOLD 400 600 700}
    recruit="Orcish Warrior, Orcish Crossbowman, Goblin Knight, Orcish Slayer, Ogre, Orcish Grunt, Orcish Archer, Wolf Rider"
    team_name=Enemies
    user_team_name=_"Enemies"
    income="6"
    [ai]
        recruitment_ignore_bad_combat=yes
        recruitment_ignore_bad_movement=yes

        [target]
        side=1
        value=5.0
        [/target]
      
        [target]
        side=2
        value=3.0
        [/target]
  
        [target]
        side=8
        value=4.0
        [/target]
 
        [target]
        side=9
        value=2.0
        [/target]
    [/ai]
    [/side]
    {STARTING_VILLAGES 7 3}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Orcish Slayer" 2} 

    [side]
    no_leader=yes
    controller=human
    side=8
    recruit=Dwarvish Fighter, Dwarvish Thunderer, Dwarvish Scout, Dwarvish Ulfserker, Dwarvish Guardsman
    {GOLD 800 600 600}
    income=4
    team_name=Alliance
    user_team_name=_"Alliance"
    [/side]
  
    [side]
    no_leader=yes
    controller=ai
    side=9
    {GOLD 800 600 600}
    income=4
    team_name=Alliance
    user_team_name=_"Alliance"
    [ai]
        recruitment_ignore_bad_combat=yes
        recruitment_ignore_bad_movement=yes
        recruitment_pattern=fighter, fighter, archer, mixed fighter, scout
        passive_leader=yes
        {NO_SCOUTS}
    [/ai]
    [/side] 

    

#define CASTLE_OF_ELVES
    x=37,37,38,38,38,39,39
    y=42,43,41,42,43,42,43
#enddef

#define CASTLE_OF_VAMAN
    x=48,48,48,48,49,49,49,50,50,50,50
    y=19,20,21,22,20,21,22,19,20,21,22
#enddef

#define CASTLE_OF_TROLLS
    x=44,44,45,45,45,46,46
    y=11,12,11,12,13,11,12
#enddef

#define AVOID_ALLIES
    [ai]
        [avoid]
            {CASTLE_OF_VAMAN}
        [/avoid]
        [avoid]
            {CASTLE_OF_ELVES}
        [/avoid]
        [avoid]
            {CASTLE_OF_TROLLS}
        [/avoid]
    [/ai]
#enddef

    [event]
    name=prestart

    [recall]
    id=Sandrom
    [/recall]
 
    [recall]
    id=Vaman
    [/recall]

    [recall]
    id=Aric
    [/recall] 

    [recall]
    id=Princess Radah
    [/recall] 

    #Krag Kumbha bodyguards
    {GENERIC_UNIT 2 (Orcish Warlord) 36 6} {GUARDIAN}
    {GENERIC_UNIT 2 (Troll Warrior) 40 6} {GUARDIAN}

    #north guards
    {GENERIC_UNIT 3 (Orcish Warlord) 27 18} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 26 18} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Warlord) 26 19} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 27 19} {GUARDIAN}

    {GENERIC_UNIT 3 (Orcish Warlord) 29 18} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 29 19} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Warlord) 30 19} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 30 18} {GUARDIAN}

    #west guards
    {GENERIC_UNIT 3 (Orcish Warlord) 16 25} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 17 26} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Warlord) 17 25} {GUARDIAN}
    
    {GENERIC_UNIT 3 (Orcish Warlord) 16 28} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 17 28} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Warlord) 17 29} {GUARDIAN}

    #south guards
    {GENERIC_UNIT 3 (Orcish Warlord) 27 36} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 26 35} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Warlord) 26 34} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 27 35} {GUARDIAN}

    {GENERIC_UNIT 3 (Orcish Warlord) 29 36} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 29 35} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Warlord) 30 34} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 30 35} {GUARDIAN}

    #east guards
    {GENERIC_UNIT 3 (Orcish Warlord) 42 25} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 41 26} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Warlord) 41 25} {GUARDIAN}
    
    {GENERIC_UNIT 3 (Orcish Warlord) 42 28} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Slurbow) 41 28} {GUARDIAN}
    {GENERIC_UNIT 3 (Orcish Warlord) 41 29} {GUARDIAN}

    [objectives]
            side=1
            [objective]
                description= _ "Defeat Bakkhil"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Krshan"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Krag Kumbha"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Vaman"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Aric"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Princess Radah"
                condition=lose
            [/objective]
            
            note={NO_GOLD_CARRYOVER_NOTE}
    [/objectives]

    [/event]

    [event]
    name=start
    [message]
    speaker=Bakkhil
    message= _ "So the human worms and stupid midgets have arrived.The coward is here too.You will face the might of my soldiers shortly."
    [/message]
    [message]
    speaker=Krshan
    message= _ "You think you can take on our combined forces alone?After what happened recently in Dorset,Prestim,Borstep,Barag Gor and Tirigaz?Well,wish you luck!"
    [/message]
    [message]
    speaker=Krag Kumbha
    message= _ "Better surrender now,and I will let you die a quick death.If I have to use force,not only you will face torture but also your accomplices will be severely punished."
    [/message]
    [message]
    speaker=Bakkhil
    message= _ "Hear,hear,the coward is speaking.It is you and your sidekicks who will face torture and death soon."
    [/message]
    [message]
    speaker=Krshan
    message= _ "So you leave us no choice but to attack you.Vaman,you dwarves know every inch of the land in those mountains.Please take the dwarves and surround them on the east.That will deny them any breathing space."
    [/message]
    [message]
    speaker=Vaman
    message= _ "All right.I will be in position by dawn."
    image=portraits/vaman.png
    [/message]
    [store_unit]
            [filter]
                id=Vaman
            [/filter]

            kill=yes
            variable=vaman
        [/store_unit]

        [store_unit]
            [filter]
                side=1
                race=dwarf
            [/filter]

            kill=yes
            variable=dwarf
        [/store_unit]
    [/event]

    [event]
        name=turn 4

        [move_unit_fake]
            type=$vaman.type
            side=8
            x=51,50,49
            y=20,20,21
        [/move_unit_fake]

        {VARIABLE vaman.x 49}
        {VARIABLE vaman.y 21}
        {VARIABLE vaman.canrecruit yes}
        {VARIABLE vaman.side 8}

        [unstore_unit]
            variable=vaman
        [/unstore_unit]

        {FOREACH dwarf m}
            {VARIABLE dwarf[$m].side 8}

            [unstore_unit]
                variable=dwarf[$m]
            [/unstore_unit]
        {NEXT m}

        {CLEAR_VARIABLE vaman,dwarf}


        [terrain]
            {CASTLE_OF_VAMAN}
            terrain=Ce
        [/terrain]

        [terrain]
            x=49
            y=21
            terrain=Ke
        [/terrain]

        [redraw]
        [/redraw]

    [message]
    speaker=Vaman
    message= _ "I am in position,Krshan."
    [/message]
    [message]
    speaker=Krshan
    message= _ "Excellent!Now see how those rebels wither under the might of the dwarves!"
    [/message]

    [objectives]
             side=8
            [objective]
                description= _ "Defeat Bakkhil"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Krshan"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Krag Kumbha"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Vaman"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Aric"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Princess Radah"
                condition=lose
            [/objective]
            
            note={NO_GOLD_CARRYOVER_NOTE}
    [/objectives]
    [/event]

    [event]
    name=turn 12 
 
    [if]
    [variable]
    name=elves
    numerical_equals=1
    [/variable]
    [then]
    
    [move_unit_fake]
    type=Elvish Enchantress
    side=9
    x=42,41,40,39,38
    y=43,43,42,42,42
    [/move_unit_fake]
    [unit]
    type=Elvish Enchantress
    id=Menoka
    name= _"Menoka"
    side=9
    x,y=38,42
    canrecruit=yes
    [/unit]

    [allow_recruit]
    side=9
    type=Elvish Fighter, Elvish Archer, Elvish Scout, Elvish Shaman, Elvish Captain, Elvish Hero, Elvish Marksman, Elvish Ranger, Elvish Druid, Elvish Sorceress
    [/allow_recruit]

        [terrain]
            {CASTLE_OF_ELVES}
            terrain=Ce
        [/terrain]

        [terrain]
            x=38
            y=42
            terrain=Ke
        [/terrain]

        [redraw]
        [/redraw]

    [message]
    speaker=Menoka
    message= _ "Dear brother Krshan,I am here to help you."
    [/message]
    [message]
    speaker=Krshan
    message= _ "Menoka?You are here?What a pleasant surprise!"
    [/message]
    [message]
    speaker=Menoka
    message= _ "I was in Wesmere when I received news of your attack on Rumyr.I have brought with me as many of the elves I could gather."
    [/message]
    [message]
    speaker=Krshan
    message= _ "How nice of you Menoka to come to our aid!Now lets crush these rebels and restore peace in the northlands and far-north."
    [/message]
    
    [/then]
    [/if]

    [if]
    [variable]
    name=trolls
    numerical_equals=1
    [/variable]
    [then]

    [move_unit_fake]
    type=Great Troll
    side=9
    x=51,50,49,48,47,46,45
    y=9,9,10,10,11,11,12
    [/move_unit_fake]
    [unit]
    type=Great Troll
    side=9
    x,y=45,12
    id=Moidanav
    name=_"Moidanav"
    canrecruit=yes
    [/unit]

    [allow_recruit]
    side=9
    type=Troll Whelp, Troll, Troll Rocklobber, Troll Shaman
    [/allow_recruit]

        [terrain]
            {CASTLE_OF_TROLLS}
            terrain=Ce
        [/terrain]

        [terrain]
            x=45
            y=12
            terrain=Ke
        [/terrain]

        [redraw]
        [/redraw]

    [message]
    speaker=Moidanav
    message= _ "Enjoying yourselves,humans and dwarves?Me come to help!"
    [/message]
    [message]
    speaker=Krshan
    message= _ "Moidanav?You are here?What a pleasant surprise!"
    [/message]
    [message]
    speaker=Moidanav
    message= _ "Me visit trolls in this area.Me got news of this battle.We come to help. Me bring many trolls."
    [/message]
    [message]
    speaker=Krshan
    message= _ "How nice of you Moidanav to come to our aid!Now lets crush these rebels and restore peace in the northlands and far-north."
    [/message]


    [/then]
    [/if]

    [message]
    speaker=Bakkhil
    message= _ "Those invaders have got more help.We must summon the reinforcements."
    [/message]
 
    [gold]
    side=3
    amount=600
    [/gold]
    [gold]
    side=4
    amount=300
    [/gold]
    [gold]
    side=5
    amount=300
    [/gold]
    [gold]
    side=6
    amount=300
    [/gold]
    [gold]
    side=7
    amount=300
    [/gold]

    [/event]

    [event]
    name=moveto
    [filter]
    side=1,2,8,9
    x=26-30
    y=25-28
    [/filter]

    [message]
    speaker=Bakkhil
    message= _ "They are getting near!Call the reserves!"
    [/message]

    {LOYAL_UNIT 3 (Orcish Warlord) 26 25} {GUARDIAN}
    {LOYAL_UNIT 3 (Orcish Slurbow) 30 25} {GUARDIAN}
    {LOYAL_UNIT 3 (Ogre) 26 28} {GUARDIAN}
    {LOYAL_UNIT 3 (Direwolf Rider) 30 28} {GUARDIAN}

    [/event]

    [event]
    name=last breath
    [filter]
    id=Menoka
    [/filter]

    [message]
    speaker=unit
    message= _ "Farewell Krshan,dear brother.Fight bravely and victory will be yours."
    [/message]
    [message]
    speaker=Krshan
    message= _ "YOU BRUTES!YOU WILL PAY FOR THIS!FORWARD MEN,CUT THESE BEASTS INTO PIECES AND FEED THEM TO THEIR OWN WOLVES!"
    [/message]

    [/event]

    [event]
    name=last breath
    [filter]
    id=Moidanav
    [/filter]

    [message]
    speaker=unit
    message= _ "Farewell Krshan.Brave fight.Victory yours will be."
    [/message]
    [message]
    speaker=Krshan
    message= _ "YOU BRUTES!YOU WILL PAY FOR THIS!FORWARD MEN,CUT THESE BEASTS INTO PIECES AND FEED THEM TO THEIR OWN WOLVES!"
    [/message]

    [/event]
    
    
    

    [event]
    name=last breath
    [filter]
    id=Bakkhil
    [/filter]

    [message]
    speaker=unit
    message= _ "Noooo!Orcs....must rule...I can't die...like this!"
    [/message]
    [message]
    speaker=Princess Radah
    message= _ "So nice are the last words of the self proclaimed orcish sovereign!"
    [/message]
    [message]
    speaker=Krag Kumbha
    message= _ "Yes,orcs are great,but not the rebel ones who know only to ransack all that is good!"
    [/message]
    [message]
    speaker=Bakkhil
    message= _ "Shame..on..you,..cowards!..May you..never..know..peace!May you...aargh..."
    [/message]
    [message]
    speaker=Krshan
    message= _ "May you shut up your ugly mouth and die quickly.For peace and prosperity of the northlands and the far-north!"
    [/message]

    

    [endlevel]
    result=victory
    bonus=no
    {NEW_GOLD_CARRYOVER 0}
    [/endlevel]

    [/event]

    
    [event]
    name=victory

    [if]
    [have_unit]
    id=Menoka
    [/have_unit]
    [then]
    [message]
    speaker=Krshan
    message= _ "Thank you so much Menoka.Please come to Dwarven Doors with us.You deserve a treat."
    [/message]
    [message]
    speaker=Menoka
    message= _ "Sounds good,little brother.We all will go after I have completed our work in Wesmere."
    [/message]
    {VARIABLE Menoka 1}
    [/then]
    [/if]

    [if]
    [have_unit]
    id=Moidanav
    [/have_unit]
    [then]
    [message]
    speaker=Krshan
    message= _ "Thank you so much Moidanav.Please come to Dwarven Doors with us.You deserve a treat."
    [/message]
    [message]
    speaker=Moidanav
    message= _ "Sounds good,Krshan.We all go after me complete our work here."
    [/message]
    {VARIABLE Moidanav 1}
    [/then]
    [/if]

    {MODIFY_UNIT (side=8) side 1}
    [/event]

    [event]
    name=last breath
    [filter]
    id=Sandrom
    [/filter]
    [message]
        speaker=unit
        message= _ "Noooo!How can this happen to me!"
    [/message]
    [/event] 

{~add-ons/Rebellion_in_the_North/utils/deaths.cfg}

[/scenario]

    



       

